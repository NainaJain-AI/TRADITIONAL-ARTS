import{j as l}from"./chunk-DaRttSCz.js";import{r as e}from"./chunk-CMRBzt0a.js";import{a as o}from"./chunk-C4w0ZaE1.js";import{u as a,D as i,t}from"./index-uUFKMaW1.js";import{y as n}from"./chunk-DaL-jLV-.js";const s=o.create({baseURL:"http://localhost:5050"});s.interceptors.request.use(l=>{const e=localStorage.getItem("token");return e&&(l.headers.Authorization="Bearer "+e),l});const r={followUser:async l=>(await s.post("/api/following/follow/"+l)).data,unfollowUser:async l=>(await s.post("/api/following/unfollow/"+l)).data,getFollowing:async()=>(await s.get("/api/following/following")).data,getFollowers:async()=>(await s.get("/api/following/followers")).data,isFollowing:async l=>{try{const e=await s.get("/api/following/following");return!!e.data.success&&e.data.following.some(e=>e.l===l)}catch(e){return!1}}},c=({isVerified:e,size:o="sm",className:a=""})=>e?l.jsx("div",{className:"inline-flex items-center justify-center "+a,title:"Verified Artist",children:l.jsx("svg",{className:{xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"}[o]+" text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}):null,d=({userId:o,className:s="",onFollowChange:c})=>{const[d,f]=e.useState(!1),[w,u]=e.useState(!1),[h,m]=e.useState(0),{user:p,isAuthenticated:g}=a();e.useEffect(()=>{g&&o&&o!==(null==p?void 0:p.id)&&o!==(null==p?void 0:p.l)&&v()},[o,g,p]);const v=async()=>{try{const l=await r.isFollowing(o);f(l)}catch(l){}};return g&&o!==(null==p?void 0:p.id)&&o!==(null==p?void 0:p.l)?l.jsx("button",{onClick:async()=>{var l,e;if(g)if(o!==(null==p?void 0:p.id)&&o!==(null==p?void 0:p.l)){u(!0);try{let l;d?(l=await r.unfollowUser(o),f(!1),m(l=>Math.max(0,l-1)),n.info("Unfollowed artist")):(l=await r.followUser(o),f(!0),m(l=>l+1),n.success("Following artist! They will be notified.")),c&&c(d,h)}catch(a){alert((null==(e=null==(l=a.response)?void 0:l.data)?void 0:e.message)||"Failed to update follow status")}finally{u(!1)}}else alert("You cannot follow yourself");else alert("Please login to follow artists")},disabled:w,className:`\n        bg-gradient-to-r from-[#134856] to-[#e05264] text-white px-6 py-3 rounded-full hover:shadow-lg transition-all font-dm-serif text-sm font-semibold flex items-center gap-2\n        ${w?"opacity-50 cursor-not-allowed":"cursor-pointer hover:scale-105"}\n        ${s}\n      `,children:w?l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),l.jsx("span",{children:"Loading..."})]}):d?l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(i,{size:14}),l.jsx("span",{children:"Following"})]}):l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(t,{size:14}),l.jsx("span",{children:"Follow"})]})}):null};export{d as F,c as V,r as f};
