import{j as e}from"./chunk-DrBkpLm2.js";import{r as a}from"./chunk-CMRBzt0a.js";import{b as r}from"./chunk-Bt6U1h1N.js";import"./chunk-ouJazw0A.js";const n=()=>{const[n,s]=a.useState([]),[t,c]=a.useState(!0),[l,i]=a.useState(""),[d,o]=a.useState("all"),[m,h]=a.useState({}),[p,N]=a.useState(null);a.useEffect(()=>{v(),u()},[d]);const v=async()=>{try{const e="all"!==d?{status:d}:{},a=await r.getReports(e);Array.isArray(a)?s(a):(s([]),i("Invalid data format received from server"))}catch(e){i("Error fetching reports: "+(e.message||"Unknown error")),s([])}finally{c(!1)}},u=async()=>{try{const e=await r.getReportStats();h(e)}catch(e){}},b=async(e,a,t="")=>{try{const c="approved"===a?"resolved":"rejected"===a?"dismissed":a;await r.updateReportStatus(e,c,t),s(n.map(r=>r.t===e?{...r,status:a,adminNotes:t,reviewedAt:new Date}:r)),N(null),u()}catch(c){i(c.message||"Error updating report")}},g=e=>{switch(e){case"pending":return"#ffa726";case"approved":return"#66bb6a";case"rejected":return"#ef5350";default:return"#757575"}},y=e=>{switch(e){case"inappropriate":return"⚠️";case"spam":return"🚫";case"copyright":return"©️";case"harassment":return"🛡️";case"other":return"❓";default:return"📝"}};return t?e.jsx("div",{className:"admin-panel",children:e.jsx("div",{className:"loading",children:"Loading admin panel..."})}):e.jsxs("div",{className:"admin-panel",children:[e.jsxs("div",{className:"admin-header",children:[e.jsx("h1",{children:"Admin Panel"}),e.jsxs("div",{className:"stats-bar",children:[e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-number",children:m.total||0}),e.jsx("span",{className:"stat-label",children:"Total Reports"})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-number",children:m.pending||0}),e.jsx("span",{className:"stat-label",children:"Pending"})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-number",children:m.approved||0}),e.jsx("span",{className:"stat-label",children:"Approved"})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-number",children:m.rejected||0}),e.jsx("span",{className:"stat-label",children:"Rejected"})]})]})]}),l&&e.jsx("div",{className:"error-message",children:l}),e.jsx("div",{className:"admin-controls",children:e.jsxs("div",{className:"filter-buttons",children:[e.jsx("button",{className:"all"===d?"active":"",onClick:()=>o("all"),children:"All Reports"}),e.jsx("button",{className:"pending"===d?"active":"",onClick:()=>o("pending"),children:"Pending"}),e.jsx("button",{className:"approved"===d?"active":"",onClick:()=>o("approved"),children:"Approved"}),e.jsx("button",{className:"rejected"===d?"active":"",onClick:()=>o("rejected"),children:"Rejected"})]})}),e.jsx("div",{className:"reports-container",children:0===n.length?e.jsx("div",{className:"no-reports",children:"No reports found for the selected filter."}):e.jsx("div",{className:"reports-grid",children:n.map(a=>e.jsxs("div",{className:"report-card",children:[e.jsxs("div",{className:"report-header",children:[e.jsxs("div",{className:"report-type",children:[e.jsx("span",{className:"type-icon",children:y(a.reason)}),e.jsx("span",{className:"type-text",children:a.reason})]}),e.jsx("div",{className:"report-status",style:{backgroundColor:g(a.status)},children:a.status})]}),e.jsxs("div",{className:"report-content",children:[e.jsxs("div",{className:"report-target",children:[e.jsx("strong",{children:"Target:"})," ",a.targetType,a.targetArtist&&" by "+a.targetArtist.name]}),e.jsxs("div",{className:"report-description",children:[e.jsx("strong",{children:"Description:"}),e.jsx("p",{children:a.description})]}),e.jsxs("div",{className:"report-reporter",children:[e.jsx("strong",{children:"Reported by:"})," ",a.reportedBy.name]}),e.jsxs("div",{className:"report-date",children:[e.jsx("strong",{children:"Submitted:"})," ",new Date(a.createdAt).toLocaleDateString()]}),a.adminNotes&&e.jsxs("div",{className:"admin-notes",children:[e.jsx("strong",{children:"Admin Notes:"}),e.jsx("p",{children:a.adminNotes})]})]}),"pending"===a.status&&e.jsx("div",{className:"report-actions",children:e.jsx("button",{className:"approve-btn",onClick:()=>N(a),children:"Review"})})]},a.t))})}),p&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"review-modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"Review Report"}),e.jsx("button",{className:"close-btn",onClick:()=>N(null),children:"×"})]}),e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"report-details",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Type:"})," ",p.reason]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Target:"})," ",p.targetType]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",p.description]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Reported by:"})," ",p.reportedBy.name]})]}),e.jsxs("div",{className:"admin-notes-input",children:[e.jsx("label",{htmlFor:"adminNotes",children:"Admin Notes (optional):"}),e.jsx("textarea",{id:"adminNotes",placeholder:"Add notes about your decision...",rows:"4"})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"approve-btn",onClick:()=>{const e=document.getElementById("adminNotes").value;b(p.t,"approved",e)},children:"Approve Report"}),e.jsx("button",{className:"reject-btn",onClick:()=>{const e=document.getElementById("adminNotes").value;b(p.t,"rejected",e)},children:"Reject Report"}),e.jsx("button",{className:"cancel-btn",onClick:()=>N(null),children:"Cancel"})]})]})]})})]})};export{n as default};
