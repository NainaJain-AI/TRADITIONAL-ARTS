import{j as e,m as t,A as a}from"./chunk-DrBkpLm2.js";import{r,L as i}from"./chunk-CMRBzt0a.js";import{u as o}from"./index-LrY4tx8y.js";import{y as n}from"./chunk-BWoFSTeq.js";import{a as s,C as l,g as c,A as d}from"./chunk-J4nWG5bO.js";import{m,q as u,F as p,a as h,n as y,r as g,f,g as x}from"./chunk-Ca7r8q3n.js";import{a as w}from"./chunk-Bt6U1h1N.js";import{F as b}from"./chunk-B12jDwHr.js";import"./chunk-ouJazw0A.js";import"./chunk-CPxFknmi.js";import"./chunk-C4w0ZaE1.js";import"./chunk-i2nP3W7I.js";import"./chunk-D-ukXXUr.js";const k=()=>{const{user:k,isAuthenticated:v}=o(),[N,C]=r.useState([]),[j,A]=r.useState(!1),[D,F]=r.useState(!0),[I,O]=r.useState(""),[P,B]=r.useState("all"),[M,S]=r.useState("newest"),[z,E]=r.useState(new Set),[H,T]=r.useState(null),[L,U]=r.useState(!1);r.useEffect(()=>{(async()=>{try{F(!0);const e=await w.getArtworks({limit:50,sortBy:"createdAt",sortOrder:"desc"});if(e.success){const t=e.data.map(e=>{var t;const a=e.userId?"object"==typeof e.userId?e.userId.t:e.userId.toString():null==(t=e.artistId)?void 0:t.toString();return{id:e.t||e.id,title:e.title||e.name,description:e.description,artist:e.artist||"Cultural Heritage",imageUrl:e.imageUrl||e.image,category:e.category||"Traditional Art",likes:e.likes||0,bookmarks:e.bookmarks||0,createdAt:e.createdAt||(new Date).toISOString(),userId:a,origin:e.origin}});C(t)}else C([])}catch(e){n.error("Failed to load artworks. Please try again later."),C([])}finally{F(!1)}})(),v&&k&&Y()},[v,k]);const Y=async()=>{try{const e=await w.getCurrentUser();if(e&&e.user){const t=new Set((e.user.bookmarks||[]).map(e=>e.toString()));E(t)}}catch(e){}},W=N.filter(e=>{const t="all"===P||e.category.toLowerCase()===P,a=e.title.toLowerCase().includes(I.toLowerCase())||e.artist.toLowerCase().includes(I.toLowerCase())||e.description.toLowerCase().includes(I.toLowerCase());return t&&a}).sort((e,t)=>{switch(M){case"newest":return new Date(t.createdAt)-new Date(e.createdAt);case"oldest":return new Date(e.createdAt)-new Date(t.createdAt);case"likes":return t.likes-e.likes;case"artist":return e.artist.localeCompare(t.artist);default:return 0}}),$=async e=>{if(v)try{const t=await w.toggleBookmark(e);t.success&&(E(a=>{const r=new Set(a),i=e.toString();return t.isBookmarked?(r.add(i),n.success("Artwork bookmarked!",{position:"top-center",autoClose:2e3}),c.emit(d.BOOKMARKED,{artworkId:i,userId:null==k?void 0:k.id})):(r.delete(i),n.success("Bookmark removed!",{position:"top-center",autoClose:2e3}),c.emit(d.UNBOOKMARKED,{artworkId:i,userId:null==k?void 0:k.id})),r}),c.emit(d.USER_STATS_UPDATED,{userId:null==k?void 0:k.id,bookmarkChange:t.isBookmarked?1:-1}))}catch(t){n.error("Failed to load bookmarks and likes. Please try again.",{position:"top-center",autoClose:3e3})}else n.error("Please login to bookmark artworks",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},q=e=>{T(e),U(!0),document.body.style.overflow="hidden"},G=()=>{U(!1),T(null),document.body.style.overflow="unset"};r.useEffect(()=>{const e=e=>{"Escape"===e.key&&L&&G()},t=()=>{L&&G()};return L&&(document.addEventListener("keydown",e),window.addEventListener("popstate",t),window.history.pushState({fullscreen:!0},"")),()=>{document.removeEventListener("keydown",e),window.removeEventListener("popstate",t)}},[L]);const X=()=>{const a=Array.from({length:15},(e,t)=>({id:t,size:4*Math.random()+2,color:["rgba(19, 72, 86, 0.6)","rgba(224, 82, 100, 0.6)","rgba(244, 140, 140, 0.6)","rgba(29, 124, 111, 0.6)","rgba(255, 215, 0, 0.6)"][Math.floor(5*Math.random())],initialX:100*Math.random(),initialY:100*Math.random(),animationDelay:5*Math.random(),animationDuration:8+6*Math.random()}));return e.jsx("div",{className:"fixed inset-0 pointer-events-none z-0",children:a.map(a=>e.jsx(t.div,{className:"absolute rounded-full opacity-40",style:{width:a.size+"px",height:a.size+"px",backgroundColor:a.color,left:a.initialX+"%",top:a.initialY+"%",filter:"blur(0.5px)",boxShadow:`0 0 ${2*a.size}px ${a.color}`},animate:{y:[0,-80,0],x:[0,25,-25,0],opacity:[.4,.7,.4],scale:[1,1.3,1]},transition:{duration:a.animationDuration,repeat:1/0,delay:a.animationDelay,ease:"easeInOut"}},a.id))})};return e.jsxs("div",{className:"min-h-screen bg-[#F8E6DA] pb-8 overflow-hidden",children:[e.jsx(b,{}),e.jsx(X,{}),e.jsxs("div",{className:"container mx-auto px-4 pt-10 relative z-10",children:[e.jsxs(t.section,{className:"text-center mb-12",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8},children:[e.jsx(t.div,{className:"absolute w-96 h-96 bg-gradient-to-r from-[#E05264]/20 to-[#F48C8C]/20 rounded-full blur-3xl opacity-30 top-0 left-0",animate:{scale:[1,1.2,1],rotate:[0,90,0],opacity:[.3,.5,.3]},transition:{duration:10,repeat:1/0,ease:"easeInOut"}}),e.jsx("h1",{className:"inline-block text-6xl font-dm-serif mb-6 drop-shadow-lg bg-gradient-to-r from-[#134856] to-[#e05264] bg-clip-text text-transparent",children:"Art Wall"}),e.jsx("p",{className:"text-lg font-lora font-semibold text-xl text-[#E05264] max-w-3xl mx-auto leading-relaxed mb-10",children:"A collaborative space where artists share their creativity and passion. Discover, appreciate, and contribute to our growing collection of artistic expressions."}),e.jsxs("div",{className:"mt-8 flex flex-col sm:flex-row gap-4 justify-center items-center",children:[e.jsxs(t.button,{onClick:()=>{v?A(!0):n.error("Please login or create an account to contribute your artwork",{position:"top-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})},className:"bg-gradient-to-r from-[#1d7c6f] to-[#f58c8c] text-white px-8 py-4 rounded-full font-semibold text-lg shadow-lg hover:shadow-xl transition-all duration-300 flex items-center gap-2 font-dm-serif",whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},children:[e.jsx(m,{className:"text-white"}),"Contribute Your Art"]}),e.jsx(t.div,{whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},children:e.jsxs(i,{to:"/community-guidelines",className:"bg-gradient-to-r from-[#1d7c6f] to-[#f58c8c] text-white px-8 py-4 rounded-full font-semibold text-lg shadow-lg hover:shadow-xl transition-all duration-300 flex items-center gap-2 font-dm-serif",children:[e.jsx(u,{className:"text-white"}),"Community Guidelines"]})})]})]}),e.jsx(t.div,{className:"bg-gradient-to-br from-[#1d7c6f] to-[#f58c8c] rounded-3xl shadow-2xl p-2 mb-8",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},children:e.jsx("div",{className:"bg-[#F8E6DA] rounded-2xl p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(p,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search artworks, artists...",value:I,onChange:e=>O(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"text-gray-600"}),e.jsx("select",{value:P,onChange:e=>B(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",children:["all","traditional","contemporary","abstract","landscape","digital"].map(t=>e.jsx("option",{value:t,children:t.charAt(0).toUpperCase()+t.slice(1)},t))})]}),e.jsxs("select",{value:M,onChange:e=>S(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",children:[e.jsx("option",{value:"newest",children:"Newest First"}),e.jsx("option",{value:"oldest",children:"Oldest First"}),e.jsx("option",{value:"likes",children:"Most Liked"}),e.jsx("option",{value:"artist",children:"By Artist"})]})]})]})})}),D&&e.jsx("div",{className:"flex justify-center items-center py-16",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-amber-600"})}),e.jsx(a,{children:e.jsx(t.div,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.4},children:W.map((t,a)=>e.jsx(s,{artwork:t,index:a,currentUser:k,isBookmarked:z.has(t.id.toString()),onLike:e=>{C(t=>t.map(t=>t.id===e?{...t,likes:t.likes+1}:t))},onBookmark:$,onImageClick:q},t.id))})}),!D&&0===W.length&&e.jsxs(t.div,{className:"text-center py-16",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸŽ¨"}),e.jsx("h3",{className:"text-2xl font-semibold text-gray-700 mb-2",children:"No artworks found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your search or filter criteria"})]}),e.jsx(a,{children:L&&H&&e.jsxs(t.div,{className:"fixed inset-0 bg-black bg-opacity-95 z-50 flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},onClick:G,children:[e.jsx(t.button,{className:"absolute top-4 right-4 text-white text-2xl hover:text-gray-300 transition-colors z-60",onClick:G,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.2},children:e.jsx(y,{})}),e.jsx(t.button,{className:"absolute top-4 right-16 text-white text-xl hover:text-gray-300 transition-colors z-60",onClick:e=>{e.stopPropagation(),(async(e,t)=>{try{const a=await fetch(e),r=await a.blob(),i=window.URL.createObjectURL(r),o=document.createElement("a");o.href=i,o.download=t.replace(/\s+/g,"_")+".jpg",document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(i),n.success("Image downloaded successfully!")}catch(a){n.error("Failed to download image. Please try again.")}})(H.imageUrl,H.title)},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.3},children:e.jsx(g,{})}),e.jsxs(t.div,{className:"relative max-w-screen-lg max-h-screen-80 w-full h-full flex items-center justify-center",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{duration:.4},onClick:e=>e.stopPropagation(),children:[e.jsx("img",{src:H.imageUrl,alt:H.title,className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl",style:{maxHeight:"85vh"}}),e.jsxs(t.div,{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black via-black/70 to-transparent p-6 rounded-b-lg",initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.3},children:[e.jsx("h3",{className:"text-white text-2xl font-bold mb-2",children:H.title}),e.jsxs("p",{className:"text-gray-300 text-lg mb-3",children:["by ",H.artist]}),e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:H.description}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-white",children:[e.jsx(f,{className:"text-red-500"}),e.jsx("span",{children:H.likes})]}),e.jsxs("div",{className:"flex items-center gap-2 text-white",children:[e.jsx(x,{className:"text-blue-500"}),e.jsx("span",{children:H.bookmarks})]}),e.jsx("span",{className:"text-gray-400 text-sm",children:H.category})]})]})]}),e.jsx(t.div,{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-gray-400 text-sm text-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:e.jsx("p",{children:"Press ESC or click outside to close"})})]})}),e.jsx(l,{isOpen:j,onClose:()=>A(!1),onSubmit:async e=>{try{const t=await w.createArtwork(e),a=t.data||t,r={id:a.t||a.id,title:a.title,description:a.description,artist:a.artist||(null==k?void 0:k.name)||"Anonymous",imageUrl:a.imageUrl,category:a.category,likes:a.likes||0,bookmarks:a.bookmarks||0,createdAt:a.createdAt||(new Date).toISOString(),userId:a.userId||(null==k?void 0:k.id)};C([r,...N]),A(!1),n.success("Your artwork has been added to the Art Wall!"),c.emit(d.CREATED,{artwork:r,userId:null==k?void 0:k.id}),localStorage.setItem("artworkCreated",Date.now().toString()),window.dispatchEvent(new CustomEvent("artworkCreated",{detail:r}))}catch(t){n.error("Failed to create artwork. Please try again.")}}})]})]})};export{k as default};
