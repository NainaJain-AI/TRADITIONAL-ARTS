import{r as e,j as s}from"./framerMotion-CogqvMXS.js";import a from"./AdminPanel-Bcwp4G7I.js";import{b as r}from"./api-B_NPPa4_.js";import{u as n}from"./index-BRMdYX2S.js";import"./vendor-BI3NJeJA.js";import"./three-wh2_sdWZ.js";const t=()=>{const[t,d]=e.useState(null),[c,o]=e.useState("dashboard"),[h,m]=e.useState([]),[x,j]=e.useState(!1),[u,g]=e.useState(""),[v,b]=e.useState(!1),[p,N]=e.useState(!1),[y,w]=e.useState(null),[f,A]=e.useState({page:1,limit:10,search:"",role:"all"}),[C,k]=e.useState({}),[S,E]=e.useState(""),[U,D]=e.useState([]),[R,L]=e.useState([]),[M,V]=e.useState(!1),$=n();e.useEffect(()=>{const e=JSON.parse(localStorage.getItem("user"));e&&d(e)},[]);const P=async()=>{try{j(!0),g("");const e=await r.getAllUsers(f);m(e.users||[]),k(e.pagination||{})}catch(e){g(`Error fetching users: ${e.message}`),m([])}finally{j(!1)}},_=async e=>{try{g(""),await r.createUser(e),b(!1),P()}catch(s){g(`Error creating user: ${s.message}`)}},I=async()=>{try{V(!0),g("");const e=await r.getAllArtworks();D(e)}catch(e){g(`Error fetching artworks: ${e.message}`),D([])}finally{V(!1)}},q=async()=>{try{V(!0),g("");const e=await r.getAllEvents({creatorRole:"Artist",upcoming:"false"});L(Array.isArray(e)?e:[])}catch(e){g(`Error fetching events: ${e.message}`),L([])}finally{V(!1)}};if(e.useEffect(()=>{"users"===c&&"Admin"===t?.role&&P()},[c,f,t]),e.useEffect(()=>{"artworks"===S?I():"events"===S&&q()},[S]),!t)return s.jsx("div",{className:"loading",children:"Loading..."});const F=()=>s.jsxs("div",{className:"dashboard-overview",children:[s.jsxs("h2",{children:["Welcome, ",t.name,"!"]}),s.jsxs("p",{children:["Role: ",s.jsx("span",{className:"role-badge",children:t.role})]}),s.jsxs("div",{className:"dashboard-cards",children:[s.jsxs("div",{className:"dashboard-card",children:[s.jsx("h3",{children:"Quick Stats"}),s.jsx("p",{children:"Your dashboard overview goes here"})]}),"Admin"===t.role&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"dashboard-card",children:[s.jsx("h3",{children:"System Status"}),s.jsx("p",{children:"All systems operational"})]}),s.jsxs("div",{className:"dashboard-card",children:[s.jsx("h3",{children:"Recent Activity"}),s.jsx("p",{children:"Monitor platform activity"})]})]}),"Artist"===t.role&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"dashboard-card",children:[s.jsx("h3",{children:"Your Artworks"}),s.jsx("p",{children:"Manage your art submissions"})]}),s.jsxs("div",{className:"dashboard-card",children:[s.jsx("h3",{children:"Performance"}),s.jsx("p",{children:"View your artwork statistics"})]})]})]})]}),O=()=>"Admin"!==t.role?s.jsx("div",{className:"access-limited",children:s.jsx("p",{children:"Limited access: You can only view your own profile."})}):s.jsxs("div",{className:"user-management",children:[s.jsxs("div",{className:"admin-header",children:[s.jsx("h2",{children:"User Management"}),s.jsx("button",{className:"btn btn-primary",onClick:()=>b(!0),children:"Create New User"})]}),u&&s.jsx("div",{className:"error-message",children:u}),s.jsxs("div",{className:"user-controls",children:[s.jsx("input",{type:"text",placeholder:"Search users by name or email...",value:f.search,onChange:e=>A(s=>({...s,search:e.target.value,page:1})),className:"search-input"}),s.jsxs("select",{value:f.role,onChange:e=>A(s=>({...s,role:e.target.value,page:1})),className:"role-filter",children:[s.jsx("option",{value:"all",children:"All Roles"}),s.jsx("option",{value:"Admin",children:"Admin"}),s.jsx("option",{value:"Artist",children:"Artist"}),s.jsx("option",{value:"Viewer",children:"Viewer"})]})]}),x?s.jsx("div",{className:"loading",children:"Loading users..."}):s.jsx("div",{className:"users-table-container",children:s.jsxs("table",{className:"users-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Name"}),s.jsx("th",{children:"Email"}),s.jsx("th",{children:"Role"}),s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Joined"}),s.jsx("th",{children:"Actions"})]})}),s.jsx("tbody",{children:0===h.length?s.jsx("tr",{children:s.jsx("td",{colSpan:"6",style:{textAlign:"center",padding:"20px"},children:"No users found"})}):h.map(e=>s.jsxs("tr",{children:[s.jsx("td",{children:e.name}),s.jsx("td",{children:e.email}),s.jsx("td",{children:s.jsx("span",{className:`role-badge ${e.role.toLowerCase()}`,children:e.role})}),s.jsx("td",{children:s.jsx("span",{className:"status-badge "+(e.isEmailVerified?"verified":"unverified"),children:e.isEmailVerified?"Verified":"Unverified"})}),s.jsx("td",{children:new Date(e.createdAt).toLocaleDateString()}),s.jsx("td",{children:s.jsxs("div",{className:"user-actions",children:[s.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>{w(e),N(!0)},disabled:e._id===t.id,children:"Change Role"}),s.jsx("button",{className:"btn btn-sm btn-danger",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this user?"))try{g(""),await r.deleteUser(e),P()}catch(s){g(`Error deleting user: ${s.message}`)}})(e._id),disabled:e._id===t.id,children:"Delete"})]})})]},e._id))})]})}),C.totalPages>1&&s.jsxs("div",{className:"pagination",children:[s.jsx("button",{onClick:()=>A(e=>({...e,page:e.page-1})),disabled:1===f.page,className:"btn btn-sm",children:"Previous"}),s.jsxs("span",{children:["Page ",f.page," of ",C.totalPages]}),s.jsx("button",{onClick:()=>A(e=>({...e,page:e.page+1})),disabled:f.page>=C.totalPages,className:"btn btn-sm",children:"Next"})]}),v&&s.jsx(l,{onClose:()=>b(!1),onSubmit:_,error:u}),p&&y&&s.jsx(i,{user:y,onClose:()=>{N(!1),w(null)},onSubmit:e=>(async(e,s)=>{try{g(""),await r.updateUserRole(e,s),N(!1),w(null),P()}catch(a){g(`Error updating role: ${a.message}`)}})(y._id,e),error:u})]}),Y=()=>"Admin"!==t.role?s.jsx("div",{className:"access-limited",children:s.jsx("p",{children:"Only admins can manage content."})}):S?"artworks"===S?s.jsxs("div",{className:"content-management",children:[s.jsxs("div",{className:"content-header",children:[s.jsx("h2",{children:"Manage Artworks"}),s.jsx("button",{className:"btn btn-secondary",onClick:()=>E(""),children:"Back to Content Management"})]}),u&&s.jsx("div",{className:"error-message",children:u}),M?s.jsx("div",{className:"loading",children:"Loading artworks..."}):s.jsxs("div",{className:"content-list",children:[s.jsxs("p",{className:"content-count",children:["Total Artworks: ",U.length]}),0===U.length?s.jsx("div",{className:"no-content",children:s.jsx("p",{children:"No artworks found."})}):s.jsx("div",{className:"artworks-grid",children:U.map(e=>s.jsxs("div",{className:"artwork-card",children:[e.imageUrl&&s.jsx("img",{src:e.imageUrl,alt:e.title,className:"artwork-image",onError:e=>{e.target.style.display="none"}}),s.jsxs("div",{className:"artwork-info",children:[s.jsx("h4",{children:e.title}),s.jsxs("p",{children:[s.jsx("strong",{children:"Artist:"})," ",e.artist?.name||"Unknown"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Category:"})," ",e.category]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Medium:"})," ",e.medium]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Price:"})," $",e.price||"N/A"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Uploaded:"})," ",new Date(e.createdAt).toLocaleDateString()]}),s.jsx("div",{className:"artwork-actions",children:s.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this artwork?"))try{g(""),await r.deleteArtwork(e),I()}catch(s){g(`Error deleting artwork: ${s.message}`)}})(e._id),children:"Delete"})})]})]},e._id))})]})]}):"events"===S?s.jsxs("div",{className:"content-management",children:[s.jsxs("div",{className:"content-header",children:[s.jsx("h2",{children:"Manage Events"}),s.jsx("button",{className:"btn btn-secondary",onClick:()=>E(""),children:"Back to Content Management"})]}),u&&s.jsx("div",{className:"error-message",children:u}),M?s.jsx("div",{className:"loading",children:"Loading events..."}):s.jsxs("div",{className:"content-list",children:[s.jsxs("p",{className:"content-count",children:["Total Events: ",R.length]}),0===R.length?s.jsxs("div",{className:"no-content",children:[s.jsx("p",{children:"No events created by artists found."}),s.jsx("p",{children:s.jsx("small",{children:"Only events created by artists (not admins) are shown here."})})]}):s.jsx("div",{className:"events-list",children:R.map(e=>s.jsx("div",{className:"event-card",children:s.jsxs("div",{className:"event-info",children:[s.jsx("h4",{children:e.title}),s.jsxs("p",{children:[s.jsx("strong",{children:"Date:"})," ",new Date(e.date).toLocaleDateString()]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Location:"})," ",e.location.venue,", ",e.location.city,", ",e.location.state]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Price:"})," ",e.price?`$${e.price}`:"Free"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Description:"})," ",e.description]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Created:"})," ",new Date(e.createdAt).toLocaleDateString()]}),s.jsx("div",{className:"event-actions",children:s.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this event?"))try{g(""),await r.deleteEvent(e),q()}catch(s){g(`Error deleting event: ${s.message}`)}})(e._id),children:"Delete"})})]})},e._id))})]})]}):null:s.jsxs("div",{className:"content-management",children:[s.jsx("h2",{children:"Content Management"}),s.jsx("p",{children:"Select what you'd like to manage:"}),s.jsxs("div",{className:"content-actions",children:[s.jsx("button",{className:"btn btn-primary",onClick:()=>E("artworks"),children:"Manage Artworks"}),s.jsx("button",{className:"btn btn-secondary",onClick:()=>E("events"),children:"Manage Events"})]})]});return s.jsxs("div",{className:"admin-dashboard",children:[s.jsxs("div",{className:"admin-header",children:[s.jsx("div",{className:"header-left",children:s.jsx("h1",{children:"Admin Panel"})}),s.jsxs("div",{className:"header-right",children:[s.jsxs("span",{className:"welcome-text",children:["Welcome, ",t.name]}),s.jsx("button",{onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("userRole"),$("/")},className:"logout-btn",children:"Logout"})]})]}),s.jsx("div",{className:"admin-nav",children:(()=>{const e=[{id:"dashboard",label:"Dashboard",roles:["Admin","Artist","Viewer"]}];return"Admin"===t.role?[...e,{id:"reports",label:"Reports",roles:["Admin"]},{id:"users",label:"Users",roles:["Admin"]},{id:"content",label:"Content",roles:["Admin"]}]:"Artist"===t.role?[...e,{id:"content",label:"My Content",roles:["Artist"]}]:e})().map(e=>s.jsx("button",{className:"nav-tab "+(c===e.id?"active":""),onClick:()=>o(e.id),children:e.label},e.id))}),s.jsx("div",{className:"admin-content",children:(()=>{switch(c){case"dashboard":default:return F();case"reports":return s.jsx(a,{});case"users":return O();case"content":return Y()}})()})]})},l=({onClose:a,onSubmit:r,error:n})=>{const[t,l]=e.useState({name:"",email:"",password:"",role:"Viewer"}),[i,d]=e.useState(!1);return s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h3",{children:"Create New User"}),s.jsx("button",{className:"close-btn",onClick:a,children:"×"})]}),s.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!i){d(!0);try{await r(t),l({name:"",email:"",password:"",role:"Viewer"})}finally{d(!1)}}},className:"modal-body",children:[n&&s.jsx("div",{className:"error-message",children:n}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Name:"}),s.jsx("input",{type:"text",value:t.name,onChange:e=>l(s=>({...s,name:e.target.value})),required:!0,disabled:i})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Email:"}),s.jsx("input",{type:"email",value:t.email,onChange:e=>l(s=>({...s,email:e.target.value})),required:!0,disabled:i})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Password:"}),s.jsx("input",{type:"password",value:t.password,onChange:e=>l(s=>({...s,password:e.target.value})),required:!0,minLength:"6",disabled:i})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"Role:"}),s.jsxs("select",{value:t.role,onChange:e=>l(s=>({...s,role:e.target.value})),disabled:i,children:[s.jsx("option",{value:"Viewer",children:"Viewer"}),s.jsx("option",{value:"Artist",children:"Artist"}),s.jsx("option",{value:"Admin",children:"Admin"})]})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{type:"button",className:"btn btn-secondary",onClick:a,disabled:i,children:"Cancel"}),s.jsx("button",{type:"submit",className:"btn btn-primary",disabled:i,children:i?"Creating...":"Create User"})]})]})]})})},i=({user:a,onClose:r,onSubmit:n,error:t})=>{const[l,i]=e.useState(a.role),[d,c]=e.useState(!1);return s.jsx("div",{className:"modal-overlay",children:s.jsxs("div",{className:"modal",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h3",{children:"Change User Role"}),s.jsx("button",{className:"close-btn",onClick:r,children:"×"})]}),s.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!d&&l!==a.role){c(!0);try{await n(l)}finally{c(!1)}}},className:"modal-body",children:[t&&s.jsx("div",{className:"error-message",children:t}),s.jsxs("p",{children:[s.jsx("strong",{children:"User:"})," ",a.name," (",a.email,")"]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Current Role:"})," ",a.role]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{children:"New Role:"}),s.jsxs("select",{value:l,onChange:e=>i(e.target.value),disabled:d,children:[s.jsx("option",{value:"Viewer",children:"Viewer"}),s.jsx("option",{value:"Artist",children:"Artist"}),s.jsx("option",{value:"Admin",children:"Admin"})]})]}),s.jsxs("div",{className:"modal-actions",children:[s.jsx("button",{type:"button",className:"btn btn-secondary",onClick:r,disabled:d,children:"Cancel"}),s.jsx("button",{type:"submit",className:"btn btn-primary",disabled:d||l===a.role,children:d?"Updating...":"Update Role"})]})]})]})})};export{t as default};
