import{j as e,m as t,A as a}from"./chunk-DaRttSCz.js";import{r as i,L as r}from"./chunk-CMRBzt0a.js";import{u as o,f as l,t as n,m as s,F as c,a as d,v as m,y as u,k as h,l as p}from"./index-uUFKMaW1.js";import{a as y,C as g,s as f,g as x,A as w}from"./chunk-wq3_2aXQ.js";import{F as b}from"./chunk-B_5sYMzl.js";import"./chunk-ouJazw0A.js";import"./chunk-ZA2d1dje.js";import"./chunk-DaL-jLV-.js";import"./chunk-C4w0ZaE1.js";import"./chunk-D-ukXXUr.js";import"./chunk-3CsDJ1i-.js";const k=()=>{const{user:k,isAuthenticated:v,updateUser:N}=o(),[C,j]=i.useState([]),[A,I]=i.useState(!1),[D,F]=i.useState(!0),[S,P]=i.useState(""),[M,z]=i.useState("all"),[E,O]=i.useState("newest"),[B,L]=i.useState(new Set),[H,T]=i.useState(new Set),[U,Y]=i.useState(null),[G,J]=i.useState(!1);i.useEffect(()=>{(async()=>{try{F(!0);const e=await l.getArtworks({limit:50,sortBy:"createdAt",sortOrder:"desc"});if(e.success){const t=e.data.map(e=>{var t;const a=e.userId?"object"==typeof e.userId?e.userId.t:e.userId.toString():null==(t=e.artistId)?void 0:t.toString();return{id:e.t||e.id,title:e.title||e.name,description:e.description,artist:e.artist||"Cultural Heritage",imageUrl:e.imageUrl||e.image,category:e.category||"Traditional Art",likes:e.likes||[],bookmarks:e.bookmarks||[],likeCount:e.likeCount||(e.likes?e.likes.length:0),bookmarkCount:e.bookmarkCount||(e.bookmarks?e.bookmarks.length:0),createdAt:e.createdAt||(new Date).toISOString(),userId:a,origin:e.origin}});j(t)}else j([])}catch(e){f.error("Failed to load artworks. Please try again later."),j([])}finally{F(!1)}})(),v&&k&&W()},[v,k]);const W=async()=>{try{const e=await l.getCurrentUser();if(e&&e.user){const t=new Set((e.user.bookmarks||[]).map(e=>e.toString()));L(t),e.user.likes&&JSON.stringify(e.user.likes)!==JSON.stringify(null==k?void 0:k.likes)&&N({likes:e.user.likes,bookmarks:e.user.bookmarks})}}catch(e){}},$=C.filter(e=>{const t="all"===M||e.category.toLowerCase()===M,a=e.title.toLowerCase().includes(S.toLowerCase())||e.artist.toLowerCase().includes(S.toLowerCase())||e.description.toLowerCase().includes(S.toLowerCase());return t&&a}).sort((e,t)=>{switch(E){case"newest":return new Date(t.createdAt)-new Date(e.createdAt);case"oldest":return new Date(e.createdAt)-new Date(t.createdAt);case"likes":return(t.likeCount||0)-(e.likeCount||0);case"artist":return e.artist.localeCompare(t.artist);default:return 0}}),X=async e=>{if(v)try{const t=await l.toggleLike(e);if(t.success){if(j(a=>a.map(a=>a.id===e?{...a,likeCount:t.likeCount,likes:t.likes,isLiking:!1}:a)),k){const a=[...k.likes||[]],i=e.toString();if(t.liked)a.find(e=>e.toString()===i)||a.push(i);else{const e=a.findIndex(e=>e.toString()===i);e>-1&&a.splice(e,1)}N({likes:a})}t.liked?(f.success("Artwork liked!",{autoClose:2e3}),x.emit(w.LIKED,{artworkId:e.toString(),userId:null==k?void 0:k.id})):(f.success("Like removed!",{autoClose:2e3}),x.emit(w.UNLIKED,{artworkId:e.toString(),userId:null==k?void 0:k.id})),x.emit(w.USER_STATS_UPDATED,{userId:null==k?void 0:k.id,likeChange:t.liked?1:-1})}}catch(t){f.error("Failed to toggle like. Please try again.")}else f.error("Please login to like artworks")},_=async e=>{if(v)try{const t=await l.toggleBookmark(e);t.success&&(L(a=>{const i=new Set(a),r=e.toString();return t.bookmarked?(i.add(r),f.success("Artwork bookmarked!",{autoClose:2e3}),x.emit(w.BOOKMARKED,{artworkId:r,userId:null==k?void 0:k.id})):(i.delete(r),f.success("Bookmark removed!",{autoClose:2e3}),x.emit(w.UNBOOKMARKED,{artworkId:r,userId:null==k?void 0:k.id})),i}),j(a=>a.map(a=>a.id===e?{...a,bookmarkCount:t.bookmarkCount,bookmarks:t.bookmarks}:a)),x.emit(w.USER_STATS_UPDATED,{userId:null==k?void 0:k.id,bookmarkChange:t.bookmarked?1:-1}))}catch(t){f.error("Failed to toggle bookmark. Please try again.")}else f.error("Please login to bookmark artworks")},q=e=>{Y(e),J(!0),document.body.style.overflow="hidden"},K=()=>{J(!1),Y(null),document.body.style.overflow="unset"};i.useEffect(()=>{const e=e=>{"Escape"===e.key&&G&&K()},t=()=>{G&&K()};return G&&(document.addEventListener("keydown",e),window.addEventListener("popstate",t),window.history.pushState({fullscreen:!0},"")),()=>{document.removeEventListener("keydown",e),window.removeEventListener("popstate",t)}},[G]);const Q=()=>{const a=Array.from({length:15},(e,t)=>({id:t,size:4*Math.random()+2,color:["rgba(19, 72, 86, 0.6)","rgba(224, 82, 100, 0.6)","rgba(244, 140, 140, 0.6)","rgba(29, 124, 111, 0.6)","rgba(255, 215, 0, 0.6)"][Math.floor(5*Math.random())],initialX:100*Math.random(),initialY:100*Math.random(),animationDelay:5*Math.random(),animationDuration:8+6*Math.random()}));return e.jsx("div",{className:"fixed inset-0 pointer-events-none z-0",children:a.map(a=>e.jsx(t.div,{className:"absolute rounded-full opacity-40",style:{width:a.size+"px",height:a.size+"px",backgroundColor:a.color,left:a.initialX+"%",top:a.initialY+"%",filter:"blur(0.5px)",boxShadow:`0 0 ${2*a.size}px ${a.color}`},animate:{y:[0,-80,0],x:[0,25,-25,0],opacity:[.4,.7,.4],scale:[1,1.3,1]},transition:{duration:a.animationDuration,repeat:1/0,delay:a.animationDelay,ease:"easeInOut"}},a.id))})};return e.jsxs("div",{className:"min-h-screen bg-[#F8E6DA] pb-8 overflow-hidden",children:[e.jsx(b,{}),e.jsx(Q,{}),e.jsxs("div",{className:"container mx-auto px-4 pt-10 relative z-10",children:[e.jsxs(t.section,{className:"text-center mb-12",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.8},children:[e.jsx(t.div,{className:"absolute w-96 h-96 bg-gradient-to-r from-[#E05264]/20 to-[#F48C8C]/20 rounded-full blur-3xl opacity-30 top-0 left-0",animate:{scale:[1,1.2,1],rotate:[0,90,0],opacity:[.3,.5,.3]},transition:{duration:10,repeat:1/0,ease:"easeInOut"}}),e.jsx("h1",{className:"inline-block text-6xl font-dm-serif mb-6 drop-shadow-lg bg-gradient-to-r from-[#134856] to-[#e05264] bg-clip-text text-transparent",children:"Art Wall"}),e.jsx("p",{className:"text-lg font-lora font-semibold text-xl text-[#E05264] max-w-3xl mx-auto leading-relaxed mb-10",children:"A collaborative space where artists share their creativity and passion. Discover, appreciate, and contribute to our growing collection of artistic expressions."}),e.jsxs("div",{className:"mt-8 flex flex-col sm:flex-row gap-4 justify-center items-center",children:[e.jsxs(t.button,{onClick:()=>{v?I(!0):f.error("Please login or create an account to contribute your artwork")},className:"bg-gradient-to-r from-[#1d7c6f] to-[#f58c8c] text-white px-8 py-4 rounded-full font-semibold text-lg shadow-lg hover:shadow-xl transition-all duration-300 flex items-center gap-2 font-dm-serif",whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},children:[e.jsx(n,{className:"text-white"}),"Contribute Your Art"]}),e.jsx(t.div,{whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},children:e.jsxs(r,{to:"/community-guidelines",className:"bg-gradient-to-r from-[#1d7c6f] to-[#f58c8c] text-white px-8 py-4 rounded-full font-semibold text-lg shadow-lg hover:shadow-xl transition-all duration-300 flex items-center gap-2 font-dm-serif",children:[e.jsx(s,{className:"text-white"}),"Community Guidelines"]})})]})]}),e.jsx(t.div,{className:"bg-gradient-to-br from-[#1d7c6f] to-[#f58c8c] rounded-3xl shadow-2xl p-2 mb-8",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},children:e.jsx("div",{className:"bg-[#F8E6DA] rounded-2xl p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search artworks, artists...",value:S,onChange:e=>P(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{className:"text-gray-600"}),e.jsx("select",{value:M,onChange:e=>z(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",children:["all","traditional","contemporary","abstract","landscape","digital"].map(t=>e.jsx("option",{value:t,children:t.charAt(0).toUpperCase()+t.slice(1)},t))})]}),e.jsxs("select",{value:E,onChange:e=>O(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-transparent",children:[e.jsx("option",{value:"newest",children:"Newest First"}),e.jsx("option",{value:"oldest",children:"Oldest First"}),e.jsx("option",{value:"likes",children:"Most Liked"}),e.jsx("option",{value:"artist",children:"By Artist"})]})]})]})})}),D&&e.jsx("div",{className:"flex justify-center items-center py-16",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-amber-600"})}),e.jsx(a,{children:e.jsx(t.div,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",initial:{opacity:0},animate:{opacity:1},transition:{duration:.8,delay:.4},children:$.map((t,a)=>{var i;return e.jsx(y,{artwork:t,index:a,currentUser:k,isBookmarked:B.has(t.id?t.id.toString():null==(i=t.t)?void 0:i.toString()),onLike:X,onBookmark:_,onImageClick:q},t.id)})})}),!D&&0===$.length&&e.jsxs(t.div,{className:"text-center py-16",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸŽ¨"}),e.jsx("h3",{className:"text-2xl font-semibold text-gray-700 mb-2",children:"No artworks found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your search or filter criteria"})]}),e.jsx(a,{children:G&&U&&e.jsxs(t.div,{className:"fixed inset-0 bg-black bg-opacity-95 z-50 flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},onClick:K,children:[e.jsx(t.button,{className:"absolute top-4 right-4 text-white text-2xl hover:text-gray-300 transition-colors z-60",onClick:K,initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.2},children:e.jsx(m,{})}),e.jsx(t.button,{className:"absolute top-4 right-16 text-white text-xl hover:text-gray-300 transition-colors z-60",onClick:e=>{e.stopPropagation(),(async(e,t)=>{try{const a=await fetch(e),i=await a.blob(),r=window.URL.createObjectURL(i),o=document.createElement("a");o.href=r,o.download=t.replace(/\s+/g,"_")+".jpg",document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(r),f.success("Image downloaded successfully!")}catch(a){f.error("Failed to download image. Please try again.")}})(U.imageUrl,U.title)},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.3},children:e.jsx(u,{})}),e.jsxs(t.div,{className:"relative max-w-screen-lg max-h-screen-80 w-full h-full flex items-center justify-center",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{duration:.4},onClick:e=>e.stopPropagation(),children:[e.jsx("img",{src:U.imageUrl,alt:U.title,className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl",style:{maxHeight:"85vh"}}),e.jsxs(t.div,{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black via-black/70 to-transparent p-6 rounded-b-lg",initial:{y:50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.3},children:[e.jsx("h3",{className:"text-white text-2xl font-bold mb-2",children:U.title}),e.jsxs("p",{className:"text-gray-300 text-lg mb-3",children:["by ",U.artist]}),e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:U.description}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-white",children:[e.jsx(h,{className:"text-red-500"}),e.jsx("span",{children:U.likeCount})]}),e.jsxs("div",{className:"flex items-center gap-2 text-white",children:[e.jsx(p,{className:"text-blue-500"}),e.jsx("span",{children:U.bookmarkCount})]}),e.jsx("span",{className:"text-gray-400 text-sm",children:U.category})]})]})]}),e.jsx(t.div,{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-gray-400 text-sm text-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:e.jsx("p",{children:"Press ESC or click outside to close"})})]})}),e.jsx(g,{isOpen:A,onClose:()=>I(!1),onSubmit:async e=>{try{const t=await l.createArtwork(e),a=t.data||t,i={id:a.t||a.id,title:a.title,description:a.description,artist:a.artist||(null==k?void 0:k.name)||"Anonymous",imageUrl:a.imageUrl,category:a.category,likes:a.likes||0,bookmarks:a.bookmarks||0,createdAt:a.createdAt||(new Date).toISOString(),userId:a.userId||(null==k?void 0:k.id)};j([i,...C]),I(!1),f.success("Your artwork has been added to the Art Wall!"),x.emit(w.CREATED,{artwork:i,userId:null==k?void 0:k.id}),localStorage.setItem("artworkCreated",Date.now().toString()),window.dispatchEvent(new CustomEvent("artworkCreated",{detail:i}))}catch(t){f.error("Failed to create artwork. Please try again.")}}})]})]})};export{k as default};
