import{r as n,aa as j,j as e}from"./index-LJXkA3a7.js";const k=()=>{const[o,c]=n.useState([]),[g,b]=n.useState(!0),[x,m]=n.useState(""),[t,l]=n.useState("all"),[i,y]=n.useState({}),[r,d]=n.useState(null);n.useEffect(()=>{f(),u()},[t]);const f=async()=>{try{const s=t!=="all"?{status:t}:{},a=await j.getReports(s);Array.isArray(a)?c(a):(console.error("API returned non-array data:",a),c([]),m("Invalid data format received from server"))}catch(s){console.error("Error fetching reports:",s),m(`Error fetching reports: ${s.message||"Unknown error"}`),c([])}finally{b(!1)}},u=async()=>{try{const s=await j.getReportStats();y(s)}catch(s){console.error("Error fetching stats:",s)}},N=async(s,a,v="")=>{try{const p=a==="approved"?"resolved":a==="rejected"?"dismissed":a;await j.updateReportStatus(s,p,v),c(o.map(h=>h._id===s?{...h,status:a,adminNotes:v,reviewedAt:new Date}:h)),d(null),u()}catch(p){m(p.message||"Error updating report")}},R=s=>{switch(s){case"pending":return"#ffa726";case"approved":return"#66bb6a";case"rejected":return"#ef5350";default:return"#757575"}},A=s=>{switch(s){case"inappropriate":return"⚠️";case"spam":return"🚫";case"copyright":return"©️";case"harassment":return"🛡️";case"other":return"❓";default:return"📝"}};return g?e.jsx("div",{className:"admin-panel",children:e.jsx("div",{className:"loading",children:"Loading admin panel..."})}):e.jsxs("div",{className:"admin-panel",children:[e.jsxs("div",{className:"admin-header",children:[e.jsx("h1",{children:"Admin Panel"}),e.jsxs("div",{className:"stats-bar",children:[e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-number",children:i.total||0}),e.jsx("span",{className:"stat-label",children:"Total Reports"})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-number",children:i.pending||0}),e.jsx("span",{className:"stat-label",children:"Pending"})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-number",children:i.approved||0}),e.jsx("span",{className:"stat-label",children:"Approved"})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-number",children:i.rejected||0}),e.jsx("span",{className:"stat-label",children:"Rejected"})]})]})]}),x&&e.jsx("div",{className:"error-message",children:x}),e.jsx("div",{className:"admin-controls",children:e.jsxs("div",{className:"filter-buttons",children:[e.jsx("button",{className:t==="all"?"active":"",onClick:()=>l("all"),children:"All Reports"}),e.jsx("button",{className:t==="pending"?"active":"",onClick:()=>l("pending"),children:"Pending"}),e.jsx("button",{className:t==="approved"?"active":"",onClick:()=>l("approved"),children:"Approved"}),e.jsx("button",{className:t==="rejected"?"active":"",onClick:()=>l("rejected"),children:"Rejected"})]})}),e.jsx("div",{className:"reports-container",children:o.length===0?e.jsx("div",{className:"no-reports",children:"No reports found for the selected filter."}):e.jsx("div",{className:"reports-grid",children:o.map(s=>e.jsxs("div",{className:"report-card",children:[e.jsxs("div",{className:"report-header",children:[e.jsxs("div",{className:"report-type",children:[e.jsx("span",{className:"type-icon",children:A(s.reason)}),e.jsx("span",{className:"type-text",children:s.reason})]}),e.jsx("div",{className:"report-status",style:{backgroundColor:R(s.status)},children:s.status})]}),e.jsxs("div",{className:"report-content",children:[e.jsxs("div",{className:"report-target",children:[e.jsx("strong",{children:"Target:"})," ",s.targetType,s.targetArtist&&` by ${s.targetArtist.name}`]}),e.jsxs("div",{className:"report-description",children:[e.jsx("strong",{children:"Description:"}),e.jsx("p",{children:s.description})]}),e.jsxs("div",{className:"report-reporter",children:[e.jsx("strong",{children:"Reported by:"})," ",s.reportedBy.name]}),e.jsxs("div",{className:"report-date",children:[e.jsx("strong",{children:"Submitted:"})," ",new Date(s.createdAt).toLocaleDateString()]}),s.adminNotes&&e.jsxs("div",{className:"admin-notes",children:[e.jsx("strong",{children:"Admin Notes:"}),e.jsx("p",{children:s.adminNotes})]})]}),s.status==="pending"&&e.jsx("div",{className:"report-actions",children:e.jsx("button",{className:"approve-btn",onClick:()=>d(s),children:"Review"})})]},s._id))})}),r&&e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"review-modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"Review Report"}),e.jsx("button",{className:"close-btn",onClick:()=>d(null),children:"×"})]}),e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"report-details",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Type:"})," ",r.reason]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Target:"})," ",r.targetType]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",r.description]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Reported by:"})," ",r.reportedBy.name]})]}),e.jsxs("div",{className:"admin-notes-input",children:[e.jsx("label",{htmlFor:"adminNotes",children:"Admin Notes (optional):"}),e.jsx("textarea",{id:"adminNotes",placeholder:"Add notes about your decision...",rows:"4"})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"approve-btn",onClick:()=>{const s=document.getElementById("adminNotes").value;N(r._id,"approved",s)},children:"Approve Report"}),e.jsx("button",{className:"reject-btn",onClick:()=>{const s=document.getElementById("adminNotes").value;N(r._id,"rejected",s)},children:"Reject Report"}),e.jsx("button",{className:"cancel-btn",onClick:()=>d(null),children:"Cancel"})]})]})]})})]})};export{k as default};
